[GitHub - Az0x7/vulnerability-Checklist: This repository contain a lot of web and api vulnerability checklist , a lot of vulnerability ideas and tips from twitter](https://github.com/Az0x7/vulnerability-Checklist)

## Privilege Escalation

#### UI Manipulation
	## ğŸ” What the Researcher Did
1. **Normal behavior of the platform:**
    - When a new user is created, they are automatically granted **default permissions**.
    - To remove or change these permissions, the user must normally have an **active membership** in a program.
    - If the user does not have this membership â†’ the UI (frontend) disables the â€œremove/edit permissionsâ€ buttons.
2. **The UI Slip (Bug):**
    - The restriction (must have membership) was enforced **only on the UI level**, not on the backend.
    - The button was simply **disabled in the HTML/JavaScript**, but the server never checked whether the user had a membership.
    - This meant that if you re-enabled the button in your browser, you could trigger the action without restriction.
3. **Exploitation steps (as the researcher did):**
    - Open the **Permissions Management page**.
    - Inspect the page with browser **DevTools (F12)**.
    - Locate the disabled button (with attribute `disabled`).
    - Remove the `disabled` attribute or edit the DOM/JavaScript to make the button clickable.
    - Click the button â†’ this sends a **valid HTTP request** to the backend.
    - Because the backend never validated membership, the action succeeded.
    - Result: the attacker could **remove or change permissions of other users** without authorization.        

---

##### âš¡ How an Attacker Could Apply It
1. **Recon:**
    - Sign up as a normal user.
    - Visit the page where permissions are displayed/controlled.
    - Notice that some UI elements (buttons, checkboxes) are **disabled**.
2. **Manipulation:**
    - Use **DevTools** to edit the frontend (remove `disabled`, modify hidden inputs, or unhide elements).
    - Or use **Burp Suite / Postman** to intercept the request and replay it with modified parameters.
3. **Execution:**
    - Send the modified request to the server.
    - Since the server does not enforce backend validation, the request is processed successfully.   
    - Attacker gains the ability to **alter permissions** even without proper membership.
---
##### ğŸ¯ Key Takeaway
- **Security must always be enforced on the backend**, not just the frontend/UI.
- UI restrictions (like hiding or disabling buttons) are only for user experience, not for security.
- Any condition (like â€œmust have membershipâ€) must be validated server-side before the action is executed.

#### To Admin through an Import Feature
what privesc or BOLA are?
	- **Privesc (Privilege Escalation)** ÙŠØ´Ø¨Ù‡ Ø´Ø®ØµÙ‹Ø§ Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù†Ù‰ ÙƒÙ…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠØŒ Ø«Ù… ÙˆØ¬Ø¯ Ù…ÙØªØ§Ø­ ØºØ±ÙØ© Ø§Ù„Ù…Ø¯ÙŠØ±.
	-  **BOLA (Broken Object Level Authorization)** ÙŠØ´Ø¨Ù‡ Ø´Ø®ØµÙ‹Ø§ ÙŠØ³ØªØ·ÙŠØ¹ ÙØªØ­ Ù…Ù„ÙØ§Øª Ø§Ù„Ø¢Ø®Ø±ÙŠÙ† ÙÙ‚Ø· Ù„Ø£Ù†Ù‡ ÙŠØ¹Ø±Ù Ø£Ø±Ù‚Ø§Ù…Ù‡Ù…ØŒ Ø¯ÙˆÙ† Ø£Ù† ÙŠÙÙ…Ù†Ø­ Ø§Ù„Ø¥Ø°Ù† Ø¨Ø°Ù„Ùƒ.
##### How an Attacker Could Replicate the Technique
Hereâ€™s a practical example of how this can be exploited in real-world testing:
##### Step 1: Discovering BOLA
- Log in as a low-privilege user (e.g., `student`).
- Observe the import feature exists in the frontend but may be disabledâ€”try triggering it in DevTools or by crafting a request manually.
- Capture the HTTP request when an admin performs the import (e.g., via Burp Suite).
- Replace the admin token with the studentâ€™s token and resend the request.
- If the import still succeeds, this confirms a BOLA or IDOR vulnerabilityâ€”backend is trusting frontend enforcement. [Medium+1](https://cristivlad.medium.com/privilege-escalation-to-admin-through-an-import-feature-ac8ac6b6abad?utm_source=chatgpt.com)
##### Step 2: Analyzing Parameters
- Examine the captured request for any behavioral flags (like `willUpdate`).
- Test if setting `willUpdate=true` alongside an existing userâ€™s email leads to updates rather than new entries.
##### Step 3: Executing Privilege Escalation
- Modify the submission to target your own account (existing email).
- Change relevant parametersâ€”especially `role` to â€œadminâ€.
- Submit the request using the studentâ€™s session.
- Refresh the UI/dashboardâ€”you should now have admin-level features.
---
##### Key Lessons & Security Implications
- **Never trust the frontend for access control**. Role checks must be enforced on the backend.
- **Import functionality, especially CSV imports**, can be risky if not properly validatedâ€”parameters like `willUpdate` can be harmful if unchecked.    
- **Role and permission elevation** should always require proper server-side validation, not just based on frontend input.

### Resource:
- [The UI Slip I Hit 750$: UI Manipulation Leading to Unauthorized Permission Changes | by Abhi Sharma - Freedium](https://freedium.cfd/https://infosecwriteups.com/the-ui-slip-i-hit-750-ui-manipulation-leading-to-unauthorized-permission-changes-d65621d8dd96)
- [Privilege Escalation to Admin through an Import Feature | by Cristi Vlad | Medium](https://cristivlad.medium.com/privilege-escalation-to-admin-through-an-import-feature-ac8ac6b6abad)
##  BAC (Broken Access Control) - IDOR (Insecure Direct Object Reference)

