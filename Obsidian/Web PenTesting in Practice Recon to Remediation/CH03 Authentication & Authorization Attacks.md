- CH03_VID01_Authentication & Authorization Testing
	What is authentication?
	O Authentication in IT refers to the process of verifying the identity of a user, device,
	or system before granting access to resources or services, It ensures that the entity
	requesting access is who or what it claims to be, The most common forms
	of authentication include:
	1. ==Password-based authentication:== The user provides a password, which is checked against
	a stored value.
	2. ==Multi-factor authentication (MFA):== This requires two or more forms of verification, such as
	a password, a physical token, or a biometric scan (e.g., fingerprint or facial recognition),
	3. ==Biometric authentication:== Uses physical characteristics, such as fingerprints or retina scans,
	to verify identity.
	4. ==Certificate-based authentication:== Uses digital certificates to authenticate devices
	or users in a network.
	5. ==Token-based authentication:== A user logs in once and receives a token that can be used for
	subsequent requests (e.g., OAuth, JWT).
	![[Pasted image 20250629040412.png]]
	https://youtu.be/z8Wq4bkNHrI
- CH03_VID02_Bypassing Authentication: OAuth Implicit Flow
	Lab: [# Lab: Authentication bypass via OAuth implicit flow](https://portswigger.net/web-security/oauth/lab-oauth-authentication-bypass-via-oauth-implicit-flow)
	Solution: https://youtu.be/APbAP8oWqVk
- CH03_VID03_JWT Security: Token Manipulation
	Lab: [# Lab: JWT authentication bypass via unverified signature](https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-unverified-signature)
	JWT Security Issues
		O Token Manipulation.
		O Weak Secrets.
		O Algorithm Confusion.
	Solution: https://youtu.be/fz_dF1fXoB4
-  CH03_VID04_JWT Security: Weak Secrets
	Lab: [# Lab: JWT authentication bypass via weak signing key](https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-weak-signing-key  )
	Tools: https://hashcat.net/hashcat/
	```
	hashcat -a 0 -m 16500 
	```
	The `-a 0` option indicates the attack mode used by Hashcat. Here,
	the value `0` corresponds to a dictionary attack, i.e. the default approach. 
	The `-m 16500` option specifies the type of hash to be attacked – in this case, type `16500` corresponds to a JWT signature
	Solution: https://youtu.be/j2iwhKs1mQU
- CH03_VID05_JWT Security: Algorithm Confusion
	Lab: [# Lab: JWT authentication bypass via algorithm confusion](https://portswigger.net/web-security/jwt/algorithm-confusion/lab-jwt-authentication-bypass-via-algorithm-confusion)
	Solution: https://youtu.be/9HQO-t2PT20
-  CH03_VID06_Breaking Authorization: Insecure Direct Object Reference (IDOR) in Action
	Lab: [# Lab: Insecure direct object references](https://portswigger.net/web-security/access-control/lab-insecure-direct-object-references)
	Solution: https://youtu.be/zeK6u8XPM-M
	الثغره ديه بتحصل لما ال server مش بيتحقق بشكل كافي من صلاحيات المستخدم قبل ما يسمحله بالوصول الي المعلومات علي ال server، بمعني ان المستخدم يقدر يعدل او يشوف بيانات مش ملكه بل تخص مستخدم اخر بسسب انه تلاعب ب Parameter يحتوي علي ال ID الخاص برقم ال User ولاتالي ال application عرض الداتي الخاصه بالمستخدم. والمشكلة التانيه في ان المطور اعتمد علي ارقام تسلسليه سهل تخمينها او توقعها
	What is authorization?
		O Authorization in IT refers to the process of granting or denying access to
		specific resources or actions based on the identity of the authenticated user or system. It occurs after authentication (verifying identity) and determines what an authenticated entity is allowed to do,
		O Authorization specifies what level of access or permissions an entity has once its identity is verified
-  CH03_VID07_Breaking Authorization: Access Control Attacks
	Labs: 
		1- [# Lab: User role controlled by request parameter](https://portswigger.net/web-security/access-control/lab-user-role-controlled-by-request-parameter)  
		2- [# Lab: Unprotected admin functionality](https://portswigger.net/web-security/access-control/lab-unprotected-admin-functionality)
	Solutions:
		1- https://youtu.be/5KjDyNwVhBU
		2- https://youtu.be/oo24Z9Wlkuc
-  CH03_VID08_Exploiting Authentication: Default Logins & Enumeration
	Lab: https://www.root-me.org/en/Challenges/Web-Server/Weak-password
		Solution:
			nikto -host http://challenge01.root-me.org/web-serveur/ch3/ 
			![[Pasted image 20250801230011.png]]

	بعض العمليات الي بنعملاها خلال مرحله ال Reconnaissance or Enumeration وينحاول نعمل User and Password Enumeration والغرض نتعرف علي شكل الباسورد المستخدم من خلال Password Policy المستخدم مثلاً بعد كام محاوله من ادخال ال Password بشكل خطاء يعمل Logout لل User (Logout Policy).  
	طيب لو جربنا نكتب بيناتات بشكل خطاء User, Password ايه رساله الخطاء الي ممكن تظهر هل بيعرفني ايه بالظبط الي خطاء في ال User او ان الUser موجود بس ال Password خطاء.  
	ممكن نجرب ندخل علي صفحة ال Sign up Page ونشوف ايه ال Password Policy  اذا كان ب *Enforce* (يفرض) شكل معياً ل Pasword او Enforce Policy او Enforce special characters ,]i وده بيساعدني نفهم شكل ال Password  المستخدمه علي ال Website علشان الناس الي بيستخدموا باسوردات سهله علشان يقدرو يفتكروها.  
	هل في Subscription email او Subscription feature موجوده علي ال Website ممكن نجرب نتلاعب في ال method المستخدمه في Email علشان ممكن تطلع معلومات ال Users  الي موجودين علي  Subscription  نقدر نوصل كمان لل Emails الخاصه بال Users.  
	اخر حاجه لو في حاجه ذي Default Password ممكن نستخدمه في ال Brute-force.
## Quiz 03
### Questions and Correct Answers
1. **How can an attacker perform user enumeration during login?**  
    Answer: By analyzing server responses and login error messages
2. **How can developers avoid algorithm confusion in JWT handling?**  
    Answer: Validate the algorithm on the server
3. **How can developers prevent brute-force attacks on JWT secrets?**  
    Answer: Use strong, randomly generated secrets
4. **In a typical OAuth integration, how can insecure handling of user identity parameters by the client application lead to account takeover?**  
    Answer: By modifying user identity parameters in the authentication request without proper validation
5. **What allows attackers to escalate privileges in JWTs?**  
    Answer: Editing the token payload
6. **What does IDOR stand for?**  
    Answer: Insecure Direct Object Reference
7. **What is a typical sign of IDOR in a web application?**  
    Answer: Direct access to files via predictable URLs
8. **What is the goal of HTTP method manipulation?**  
    Answer: Modify HTTP request verbs to bypass access controls
9. **What is the primary goal of authentication testing?**  
    Answer: Bypass login mechanisms
10. **What is the primary reason for the algorithm confusion vulnerability in JWTs, particularly in the RSA vs HS256 scenario?**  
    Answer: Failing to validate the algorithm before verifying the signature
11. **What is the primary technique for bypassing HTTP request method restrictions using the GET for POST bypass technique?**  
    Answer: Manipulating the request body to include POST data in a GET request (or vice versa)
12. **What is vertical privilege escalation?**  
    Answer: Gaining admin rights from a user account
13. **What technique helps in detecting valid usernames?**  
    Answer: Analyzing HTTP error messages
14. **What tool can brute-force weak JWT secrets?**  
    Answer: Hashcat
15. **What vulnerability is associated with the OAuth implicit flow?**  
    Answer: Token leakage in URL fragments
16. **Which HTTP response code often indicates unauthorized access?**  
    Answer: 403
17. **Which part of a JWT contains user permissions?**  
    Answer: Payload
18. **Why are default credentials dangerous?**  
    Answer: They are usually weak and public